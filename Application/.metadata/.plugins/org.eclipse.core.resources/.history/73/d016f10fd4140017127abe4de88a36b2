package controllers;

import javax.inject.Inject;

import models.Proposal;
import models.ProposalVM;
import models.User;
import models.UserVM;
import play.data.Form;
import play.data.FormFactory;
import play.mvc.Controller;
import play.mvc.Result;
import services.data.dao.IPropositionDAO;
import services.data.dao.IUserDAO;
import services.data.jpaDao.UserDAO;
import views.html.*;

public class ProposalController extends Controller {

	private final FormFactory formFactory;
	private final IPropositionDAO propositionDAO;

	@Inject
	public ProposalController(FormFactory formFactory, IPropositionDAO propositionDAO) {

		this.formFactory = formFactory;
		this.propositionDAO = propositionDAO;
	}

	public Result proposalAction() {
		Form<ProposalVM> proposalVM = formFactory.form(ProposalVM.class);
		String username = session("username");
		
		boolean isAlert = false;
		
		return ok(proposalForm.render(proposalVM, username, isAlert));
	}

	public Result addProposalAction() { 
		ProposalVM proposalVM= formFactory.form(ProposalVM.class).bindFromRequest().get();
		
		long idAuthor = Long.parseLong(session("idUser"));
		proposalVM.setProposalAuthorId(proposalAuthorId);
		
		Form<ProposalVM> proposalVMForm = formFactory.form(ProposalVM.class);
	    String username = session("prenom");
	    
	    boolean isAlert = true;
		return ok(proposalForm.render(proposalVMForm, username, isAlert));
	}

	public Result getAllProposalsAction() {
		String lastName = session("prenom");
		
		return ok(propositions.render(lastName));
	}

	public Result detailProposalAction() {
		return ok();
	}

	public Result editProposalAction() {
		return ok();
	}

	public Result deleteProposalAction() {
		return ok();
	}

}
